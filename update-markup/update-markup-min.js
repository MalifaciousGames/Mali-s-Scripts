/* Mali's update markup */

((e=!1)=>{const t=Wikifier.helpers.shadowHandler||Wikifier.helpers.createShadowSetterCallback,r=[],a=()=>{if(e)return;let t=r.length-1;for(;t>=0;){const{wrapper:e,shadowGetter:a}=r[t];if(!e.isConnected){r.splice(t--,1);continue}const i=stringFrom(a());e.innerText!==i&&(e.innerText=i),t--}e=!0,setTimeout((()=>e=!1),150)};Wikifier.Parser.add({name:"updateMarkup",match:"{.*?{.*?}}",handler(e){const[a,i,n]=e.matchText.match(/{(.*?){(.*?)}}/),p=$(`<${i.trim()||"span"} aria-live='polite'>`)[0];r.push({wrapper:p,shadowGetter:t(`State.getVar("${n.replace(/"|'|`/g,(e=>`\\${e}`))}")`)}),p.innerText=stringFrom(State.getVar(n)),e.output.appendChild(p)}}),$(document).on("change click drop keyup",a),setup.updateWrappers=a,Wikifier.Parser.Profile.compile()})();